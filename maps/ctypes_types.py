import re
import sys
import ast
import base64
import marshal
import struct
import io as _io
import textwrap
import warnings
from dataclasses import dataclass, field
from typing import Optional, List, Dict, Tuple, Any, Set

warnings.filterwarnings('ignore', category=SyntaxWarning)

CTYPES_TYPE_MAP = {
    'c_bool': 'ctypes.c_bool',
    'c_byte': 'ctypes.c_byte',
    'c_ubyte': 'ctypes.c_ubyte',
    'c_char': 'ctypes.c_char',
    'c_wchar': 'ctypes.c_wchar',
    'c_short': 'ctypes.c_short',
    'c_ushort': 'ctypes.c_ushort',
    'c_int': 'ctypes.c_int',
    'c_uint': 'ctypes.c_uint',
    'c_long': 'ctypes.c_long',
    'c_ulong': 'ctypes.c_ulong',
    'c_longlong': 'ctypes.c_longlong',
    'c_ulonglong': 'ctypes.c_ulonglong',
    'c_float': 'ctypes.c_float',
    'c_double': 'ctypes.c_double',
    'c_longdouble': 'ctypes.c_longdouble',
    'c_char_p': 'ctypes.c_char_p',
    'c_wchar_p': 'ctypes.c_wchar_p',
    'c_void_p': 'ctypes.c_void_p',
    'c_voidp': 'ctypes.c_voidp',
    'c_int8': 'ctypes.c_int8',
    'c_int16': 'ctypes.c_int16',
    'c_int32': 'ctypes.c_int32',
    'c_int64': 'ctypes.c_int64',
    'c_uint8': 'ctypes.c_uint8',
    'c_uint16': 'ctypes.c_uint16',
    'c_uint32': 'ctypes.c_uint32',
    'c_uint64': 'ctypes.c_uint64',
    'c_size_t': 'ctypes.c_size_t',
    'c_ssize_t': 'ctypes.c_ssize_t',
    'c_time_t': 'ctypes.c_time_t',
    'c_buffer': 'ctypes.c_buffer',
    'py_object': 'ctypes.py_object',
    'Structure': 'ctypes.Structure',
    'Union': 'ctypes.Union',
    'BigEndianStructure': 'ctypes.BigEndianStructure',
    'LittleEndianStructure': 'ctypes.LittleEndianStructure',
    'BigEndianUnion': 'ctypes.BigEndianUnion',
    'LittleEndianUnion': 'ctypes.LittleEndianUnion',
    'POINTER': 'ctypes.POINTER',
    'Array': 'ctypes.Array',
    'ARRAY': 'ctypes.ARRAY',
    'CFUNCTYPE': 'ctypes.CFUNCTYPE',
    'WINFUNCTYPE': 'ctypes.WINFUNCTYPE',
    'PYFUNCTYPE': 'ctypes.PYFUNCTYPE',
    'CDLL': 'ctypes.CDLL',
    'PyDLL': 'ctypes.PyDLL',
    'LibraryLoader': 'ctypes.LibraryLoader',
    'HRESULT': 'ctypes.HRESULT',
    'ArgumentError': 'ctypes.ArgumentError',
    'DEFAULT_MODE': 'ctypes.DEFAULT_MODE',
    'RTLD_GLOBAL': 'ctypes.RTLD_GLOBAL',
    'RTLD_LOCAL': 'ctypes.RTLD_LOCAL',
    'SIZEOF_TIME_T': 'ctypes.SIZEOF_TIME_T',
    'SetPointerType': 'ctypes.SetPointerType',
    'addressof': 'ctypes.addressof',
    'alignment': 'ctypes.alignment',
    'byref': 'ctypes.byref',
    'cast': 'ctypes.cast',
    'cdll': 'ctypes.cdll',
    'create_string_buffer': 'ctypes.create_string_buffer',
    'create_unicode_buffer': 'ctypes.create_unicode_buffer',
    'get_errno': 'ctypes.get_errno',
    'memmove': 'ctypes.memmove',
    'memset': 'ctypes.memset',
    'pointer': 'ctypes.pointer',
    'pydll': 'ctypes.pydll',
    'pythonapi': 'ctypes.pythonapi',
    'resize': 'ctypes.resize',
    'set_errno': 'ctypes.set_errno',
    'sizeof': 'ctypes.sizeof',
    'string_at': 'ctypes.string_at',
    'wstring_at': 'ctypes.wstring_at',
    'windll': 'ctypes.windll',
    'oledll': 'ctypes.oledll',
    'WinDLL': 'ctypes.WinDLL',
    'OleDLL': 'ctypes.OleDLL',
    'HANDLE': 'ctypes.wintypes.HANDLE',
    'HWND': 'ctypes.wintypes.HWND',
    'DWORD': 'ctypes.wintypes.DWORD',
    'WORD': 'ctypes.wintypes.WORD',
    'BOOL': 'ctypes.wintypes.BOOL',
    'BYTE': 'ctypes.wintypes.BYTE',
    'LONG': 'ctypes.wintypes.LONG',
    'ULONG': 'ctypes.wintypes.ULONG',
    'WCHAR': 'ctypes.wintypes.WCHAR',
    'LPVOID': 'ctypes.c_void_p',
    'LPCVOID': 'ctypes.c_void_p',
    'LPSTR': 'ctypes.c_char_p',
    'LPCSTR': 'ctypes.c_char_p',
    'LPWSTR': 'ctypes.c_wchar_p',
    'LPCWSTR': 'ctypes.c_wchar_p',
    'LPBYTE': 'ctypes.POINTER(ctypes.c_byte)',
    'LPWORD': 'ctypes.POINTER(ctypes.wintypes.WORD)',
    'LPDWORD': 'ctypes.POINTER(ctypes.wintypes.DWORD)',
    'LPLONG': 'ctypes.POINTER(ctypes.wintypes.LONG)',
    'LPBOOL': 'ctypes.POINTER(ctypes.wintypes.BOOL)',
    'LPHANDLE': 'ctypes.POINTER(ctypes.wintypes.HANDLE)',
    'UINT': 'ctypes.c_uint',
    'INT': 'ctypes.c_int',
    'USHORT': 'ctypes.c_ushort',
    'SHORT': 'ctypes.c_short',
    'ULONGLONG': 'ctypes.c_ulonglong',
    'LONGLONG': 'ctypes.c_longlong',
    'SIZE_T': 'ctypes.c_size_t',
    'SSIZE_T': 'ctypes.c_ssize_t',
    'ULONG_PTR': 'ctypes.POINTER(ctypes.c_ulong)',
    'LONG_PTR': 'ctypes.POINTER(ctypes.c_long)',
    'UINT_PTR': 'ctypes.POINTER(ctypes.c_uint)',
    'DWORD_PTR': 'ctypes.POINTER(ctypes.wintypes.DWORD)',
    'WPARAM': 'ctypes.c_size_t',
    'LPARAM': 'ctypes.c_ssize_t',
    'LRESULT': 'ctypes.c_ssize_t',
    'ATOM': 'ctypes.c_uint16',
    'COLORREF': 'ctypes.wintypes.COLORREF',
    'HMODULE': 'ctypes.wintypes.HMODULE',
    'HINSTANCE': 'ctypes.wintypes.HINSTANCE',
    'HDC': 'ctypes.wintypes.HDC',
    'HGDIOBJ': 'ctypes.wintypes.HGDIOBJ',
    'HBITMAP': 'ctypes.wintypes.HBITMAP',
    'HBRUSH': 'ctypes.wintypes.HBRUSH',
    'HPEN': 'ctypes.wintypes.HPEN',
    'HFONT': 'ctypes.wintypes.HFONT',
    'HMENU': 'ctypes.wintypes.HMENU',
    'HICON': 'ctypes.wintypes.HICON',
    'HCURSOR': 'ctypes.wintypes.HCURSOR',
    'HKEY': 'ctypes.wintypes.HKEY',
    'HACCEL': 'ctypes.wintypes.HACCEL',
    'HFILE': 'ctypes.wintypes.HFILE',
    'HGLOBAL': 'ctypes.wintypes.HGLOBAL',
    'HLOCAL': 'ctypes.wintypes.HLOCAL',
    'HPALETTE': 'ctypes.wintypes.HPALETTE',
    'HRGN': 'ctypes.wintypes.HRGN',
    'HRSRC': 'ctypes.wintypes.HRSRC',
    'HWINSTA': 'ctypes.wintypes.HWINSTA',
    'HDESK': 'ctypes.wintypes.HDESK',
    'HTASK': 'ctypes.wintypes.HTASK',
    'HMETAFILE': 'ctypes.wintypes.HMETAFILE',
    'HENHMETAFILE': 'ctypes.wintypes.HENHMETAFILE',
    'LPPOINT': 'ctypes.POINTER(ctypes.wintypes.POINT)',
    'LPRECT': 'ctypes.POINTER(ctypes.wintypes.RECT)',
    'LPSIZE': 'ctypes.POINTER(ctypes.wintypes.SIZE)',
    'LPMSG': 'ctypes.POINTER(ctypes.wintypes.MSG)',
    'POINT': 'ctypes.wintypes.POINT',
    'RECT': 'ctypes.wintypes.RECT',
    'SIZE': 'ctypes.wintypes.SIZE',
    'MSG': 'ctypes.wintypes.MSG',
    'FILETIME': 'ctypes.wintypes.FILETIME',
    'SYSTEMTIME': 'ctypes.wintypes.SYSTEMTIME',
    'SECURITY_ATTRIBUTES': 'ctypes.wintypes.SECURITY_ATTRIBUTES',
    'OVERLAPPED': 'ctypes.wintypes.OVERLAPPED',
    'PROCESS_INFORMATION': 'ctypes.wintypes.PROCESS_INFORMATION',
    'STARTUPINFO': 'ctypes.wintypes.STARTUPINFO',
    'STARTUPINFOEX': 'ctypes.wintypes.STARTUPINFOEX',
    'LOGFONT': 'ctypes.wintypes.LOGFONT',
    'LOGFONTA': 'ctypes.wintypes.LOGFONTA',
    'LOGFONTW': 'ctypes.wintypes.LOGFONTW',
    'TEXTMETRIC': 'ctypes.wintypes.TEXTMETRIC',
    'MEMORYSTATUS': 'ctypes.wintypes.MEMORYSTATUS',
    'MEMORYSTATUSEX': 'ctypes.wintypes.MEMORYSTATUSEX',
    'BY_HANDLE_FILE_INFORMATION': 'ctypes.wintypes.BY_HANDLE_FILE_INFORMATION',
    'WIN32_FIND_DATA': 'ctypes.wintypes.WIN32_FIND_DATA',
    'CREATESTRUCT': 'ctypes.wintypes.CREATESTRUCT',
    'PAINTSTRUCT': 'ctypes.wintypes.PAINTSTRUCT',
    'WINDOWPOS': 'ctypes.wintypes.WINDOWPOS',
    'SCROLLINFO': 'ctypes.wintypes.SCROLLINFO',
    'MOUSEINPUT': 'ctypes.wintypes.MOUSEINPUT',
    'KEYBDINPUT': 'ctypes.wintypes.KEYBDINPUT',
    'HARDWAREINPUT': 'ctypes.wintypes.HARDWAREINPUT',
    'INPUT': 'ctypes.wintypes.INPUT',
    'MINMAXINFO': 'ctypes.wintypes.MINMAXINFO',
    'NCCALCSIZE_PARAMS': 'ctypes.wintypes.NCCALCSIZE_PARAMS',
    'TRACKMOUSEEVENT': 'ctypes.wintypes.TRACKMOUSEEVENT',
    'FLASHWINFO': 'ctypes.wintypes.FLASHWINFO',
    'WNDCLASSEX': 'ctypes.wintypes.WNDCLASSEX',
    'WNDCLASS': 'ctypes.wintypes.WNDCLASS',
    'OSVERSIONINFO': 'ctypes.wintypes.OSVERSIONINFO',
    'SYSTEM_INFO': 'ctypes.wintypes.SYSTEM_INFO',
    'CRITICAL_SECTION': 'ctypes.wintypes.CRITICAL_SECTION',
    'GUID': 'ctypes.wintypes.GUID',
    'IID': 'ctypes.wintypes.IID',
    'CLSID': 'ctypes.wintypes.CLSID',
    'VARIANT_BOOL': 'ctypes.c_short',
    'BSTR': 'ctypes.c_wchar_p',
    'VARIANT': 'ctypes.c_void_p',
    'SAFEARRAY': 'ctypes.c_void_p',
    'DISPID': 'ctypes.c_long',
    'MEMBERID': 'ctypes.c_long',
    'SCODE': 'ctypes.c_long',
    'LCID': 'ctypes.c_ulong',
    'LANGID': 'ctypes.c_ushort',
    'MAKELANGID': 'ctypes.c_ushort',
    'SUBLANGID': 'ctypes.c_ushort',
    'PRIMARYLANGID': 'ctypes.c_ushort',
    'ACCESS_MASK': 'ctypes.c_ulong',
    'REGSAM': 'ctypes.c_ulong',
    'LPSECURITY_ATTRIBUTES': 'ctypes.POINTER(ctypes.wintypes.SECURITY_ATTRIBUTES)',
    'PSECURITY_ATTRIBUTES': 'ctypes.POINTER(ctypes.wintypes.SECURITY_ATTRIBUTES)',
    'PSID': 'ctypes.c_void_p',
    'PACL': 'ctypes.c_void_p',
    'PSECURITY_DESCRIPTOR': 'ctypes.c_void_p',
    'PTOKEN_PRIVILEGES': 'ctypes.c_void_p',
    'POBJECT_ATTRIBUTES': 'ctypes.c_void_p',
    'IO_STATUS_BLOCK': 'ctypes.c_void_p',
    'UNICODE_STRING': 'ctypes.c_void_p',
    'NTSTATUS': 'ctypes.c_long',
    'PVOID': 'ctypes.c_void_p',
    'UCHAR': 'ctypes.c_ubyte',
    'PUCHAR': 'ctypes.POINTER(ctypes.c_ubyte)',
    'PULONG': 'ctypes.POINTER(ctypes.wintypes.ULONG)',
    'PULONG_PTR': 'ctypes.POINTER(ctypes.c_ulong)',
    'PULONGLONG': 'ctypes.POINTER(ctypes.c_ulonglong)',
    'PLARGE_INTEGER': 'ctypes.POINTER(ctypes.c_int64)',
    'LARGE_INTEGER': 'ctypes.c_int64',
    'ULARGE_INTEGER': 'ctypes.c_uint64',
    'PULARGE_INTEGER': 'ctypes.POINTER(ctypes.c_uint64)',
    'BOOLEAN': 'ctypes.c_ubyte',
    'PBOOLEAN': 'ctypes.POINTER(ctypes.c_ubyte)',
    'PBOOL': 'ctypes.POINTER(ctypes.wintypes.BOOL)',
    'PINT': 'ctypes.POINTER(ctypes.c_int)',
    'PUINT': 'ctypes.POINTER(ctypes.c_uint)',
    'PSHORT': 'ctypes.POINTER(ctypes.c_short)',
    'PUSHORT': 'ctypes.POINTER(ctypes.c_ushort)',
    'PBYTE': 'ctypes.POINTER(ctypes.wintypes.BYTE)',
    'PWORD': 'ctypes.POINTER(ctypes.wintypes.WORD)',
    'PDWORD': 'ctypes.POINTER(ctypes.wintypes.DWORD)',
    'PLONG': 'ctypes.POINTER(ctypes.wintypes.LONG)',
    'PHANDLE': 'ctypes.POINTER(ctypes.wintypes.HANDLE)',
    'PHKEY': 'ctypes.POINTER(ctypes.wintypes.HKEY)',
    'PCHAR': 'ctypes.c_char_p',
    'PWCHAR': 'ctypes.c_wchar_p',
    'PSTR': 'ctypes.c_char_p',
    'PWSTR': 'ctypes.c_wchar_p',
    'PCSTR': 'ctypes.c_char_p',
    'PCWSTR': 'ctypes.c_wchar_p',
    'LPCTSTR': 'ctypes.c_wchar_p',
    'LPTSTR': 'ctypes.c_wchar_p',
    'TCHAR': 'ctypes.c_wchar',
    'SC_HANDLE': 'ctypes.wintypes.HANDLE',
    'SERVICE_STATUS_HANDLE': 'ctypes.wintypes.HANDLE',
    'HWINEVENTHOOK': 'ctypes.wintypes.HANDLE',
    'HDEVNOTIFY': 'ctypes.wintypes.HANDLE',
    'HPOWERNOTIFY': 'ctypes.wintypes.HANDLE',
    'HRAWINPUT': 'ctypes.wintypes.HANDLE',
    'HTOUCHINPUT': 'ctypes.wintypes.HANDLE',
    'HGESTUREINFO': 'ctypes.wintypes.HANDLE',
    'HMONITOR': 'ctypes.wintypes.HANDLE',
    'HINTERNET': 'ctypes.c_void_p',
    'HCERTSTORE': 'ctypes.c_void_p',
    'PCCERT_CONTEXT': 'ctypes.c_void_p',
    'HCRYPTPROV': 'ctypes.c_void_p',
    'HCRYPTKEY': 'ctypes.c_void_p',
    'HCRYPTHASH': 'ctypes.c_void_p',
    'HCRYPTMSG': 'ctypes.c_void_p',
    'HCRYPTOIDFUNCADDR': 'ctypes.c_void_p',
    'SOCKET': 'ctypes.c_uint',
    'SOCKADDR': 'ctypes.c_void_p',
    'WSADATA': 'ctypes.c_void_p',
    'ADDRINFO': 'ctypes.c_void_p',
    'ADDRINFOEX': 'ctypes.c_void_p',
    'PADDRINFO': 'ctypes.c_void_p',
    'in_addr': 'ctypes.c_uint32',
    'in6_addr': 'ctypes.c_byte * 16',
    'SOCKADDR_IN': 'ctypes.c_void_p',
    'SOCKADDR_IN6': 'ctypes.c_void_p',
    'DEVICEDRIVERINFODATA': 'ctypes.c_void_p',
    'PIXELFORMATDESCRIPTOR': 'ctypes.c_void_p',
    'HGLRC': 'ctypes.wintypes.HANDLE',
    'HPBUFFERARB': 'ctypes.c_void_p',
    'GLuint': 'ctypes.c_uint',
    'GLint': 'ctypes.c_int',
    'GLfloat': 'ctypes.c_float',
    'GLdouble': 'ctypes.c_double',
    'GLenum': 'ctypes.c_uint',
    'GLsizei': 'ctypes.c_int',
    'GLboolean': 'ctypes.c_ubyte',
    'GLbitfield': 'ctypes.c_uint',
    'GLbyte': 'ctypes.c_byte',
    'GLshort': 'ctypes.c_short',
    'GLubyte': 'ctypes.c_ubyte',
    'GLushort': 'ctypes.c_ushort',
    'GLulong': 'ctypes.c_ulong',
    'GLvoid': 'ctypes.c_void_p',
    'GLchar': 'ctypes.c_char',
    'GLsizeiptr': 'ctypes.c_ssize_t',
    'GLintptr': 'ctypes.c_ssize_t',
    'GLint64': 'ctypes.c_int64',
    'GLuint64': 'ctypes.c_uint64',
    'GLsync': 'ctypes.c_void_p',
    'VkResult': 'ctypes.c_int',
    'VkBool32': 'ctypes.c_uint',
    'VkFlags': 'ctypes.c_uint',
    'VkDeviceSize': 'ctypes.c_uint64',
    'VkSampleMask': 'ctypes.c_uint',
    'VkInstance': 'ctypes.c_void_p',
    'VkPhysicalDevice': 'ctypes.c_void_p',
    'VkDevice': 'ctypes.c_void_p',
    'VkQueue': 'ctypes.c_void_p',
    'VkCommandBuffer': 'ctypes.c_void_p',
    'time_t': 'ctypes.c_time_t',
    'clock_t': 'ctypes.c_ulong',
    'dev_t': 'ctypes.c_uint',
    'ino_t': 'ctypes.c_ulong',
    'mode_t': 'ctypes.c_uint',
    'off_t': 'ctypes.c_long',
    'pid_t': 'ctypes.c_int',
    'uid_t': 'ctypes.c_uint',
    'gid_t': 'ctypes.c_uint',
    'nlink_t': 'ctypes.c_ulong',
    'blksize_t': 'ctypes.c_long',
    'blkcnt_t': 'ctypes.c_long',
    'int8_t': 'ctypes.c_int8',
    'int16_t': 'ctypes.c_int16',
    'int32_t': 'ctypes.c_int32',
    'int64_t': 'ctypes.c_int64',
    'uint8_t': 'ctypes.c_uint8',
    'uint16_t': 'ctypes.c_uint16',
    'uint32_t': 'ctypes.c_uint32',
    'uint64_t': 'ctypes.c_uint64',
    'intptr_t': 'ctypes.c_ssize_t',
    'uintptr_t': 'ctypes.c_size_t',
    'ptrdiff_t': 'ctypes.c_ssize_t',
    'intmax_t': 'ctypes.c_int64',
    'uintmax_t': 'ctypes.c_uint64',
    'wchar_t': 'ctypes.c_wchar',
    'char16_t': 'ctypes.c_uint16',
    'char32_t': 'ctypes.c_uint32',
}

